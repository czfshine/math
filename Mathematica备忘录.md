> 最近在科学松鼠会看到[这篇文章](http://songshuhui.net/archives/23604),挺有趣的，顺带跑去学了下Mathematica

[TOC]
准备工作
=========
去[Wolfram](http://www.wolframcloud.com/)注册个账户，15天的预览版，包括本地的和在线版。~~够用了╮(╯_╰)╭~~


语法预览
========
官方有一堆的文档(3.5G,比软件本体还大），照着文档学。

### 运行代码
+ 打开编辑器
+ 新建notebook
+ 找个空位点一下
+ 输入表达式
+ 按Shift+enter 运行


### 变量名

* 大写开头是内置函数
* 可以是特殊符号，如$\pi,\xi$ etc.输入用`\[Pi]``\[Xi]`
* ~~可以是图片或其他一些奇奇怪怪的东西~~

### 基本运算符

* `+-*/^` 加减乘除幂都有（乘号可以用空格代替`a b == a*b`)
* 数组用{,},索引用[[n]],切片用[[a;;b]]
* 函数调用用\[\](不是括号!!!)
* 赋值用= 和`:=`,差别看下面
``` mathematica
In[43]:=
    F = Random[]
    G := Random[]
    {F, F, F}
    {G, G, G}
Out[43]= 0.533218
Out[45]= {0.533218, 0.533218, 0.533218}
Out[46]= {0.630372, 0.748954, 0.950886}
```

### 函数定义
* 基本格式 Funtion[arg_]:= body
eg.
``` mathematica
In[50]:= 
f[x_] := x^2 + 1
f[1]

Out[51]= 2
```
~~别问我x后面的下划线是什么鬼，我也不知道,文档就是这么写的~~

解方程：
``` mathematica
In[150]:= two [a_, b_, c_] := Solve[a x^2 + b x + c == 0, x ]
two[8, 6, 1]

Out[151]= {{x -> -(1/2)}, {x -> -(1/4)}}

```

###　规则
上面那个解方程后的结果是`x ->-(1/2)`,这种形式叫做规则（rule）.
规则就是查找替换，查找左边的替换成右边的

* 应用规则用`/.`
eg.
``` mathematica
In[155]:= 1 + j /. j -> r^2

Out[155]= 1 + r^2
```
或者是Replace函数,目测/.就是个语法糖.

```
In[157]:= Replace[1 + j, j -> r^2, {1}]

Out[157]= 1 + r^2

```
用来在解方程后提取特定变量的解
```
In[160]:= 
out = Solve[x^2 + 2 y^3 == 3681 && x > 0 && y > 0, {x, y}, Integers]
Replace[x, out]

Out[160]= {{x -> 15, y -> 12}, {x -> 41, y -> 10}, {x -> 57, y -> 6}}

Out[161]= {15, 41, 57}

```

### 重复重复重复

* Apply可以把参数应用到函数里
```
In[8]:= 
Apply[two, {8, 6, 1}]

Out[8]= {{x -> -(1/2)}, {x -> -(1/4)}}

```
如果有一大堆参数要应用，也可以(想象一些这些参数列表是从别的地方生成的）
```
In[7]:= Apply[two, {{8, 6, 1}, {7, 10, 4}}, {1}]

Out[7]= {{{x -> -(1/2)}, {x -> -(1/4)}}, {{x -> 
    1/7 (-5 - I Sqrt[3])}, {x -> 1/7 (-5 + I Sqrt[3])}}}
```

* Map用来做映射
```
In[173]:= 
a =.
Map[f, {a, b, c, d}]
Out[174]= {f[a], f[b], f[c], f[d]}
```
求和(实现循环)
```
In[167]:= 
a = Range[10];
sum = 0;
t[x_] := 
    sum = sum + a[[x]]
Map[t, Range[10], {1}]

Out[170]= {1, 3, 6, 10, 15, 21, 28, 36, 45, 55}
```
* Table 拿来生成表格
```
In[175]:= Table[x + 1, {x, {1, 2, 3}}]

Out[175]= {2, 3, 4}
```
二维
```
Table[{x, y}, {x, {a, b, c}}, {y, {e, f, g}}] // MatrixForm
```
输出为:
$$\left(
\begin{array}{ccc}
 \{a,e\} & \{a,f\} & \{a,g\} \\
 \{b,e\} & \{b,f\} & \{b,g\} \\
 \{c,e\} & \{c,f\} & \{c,g\} \\
\end{array}
\right)$$

> f[ ]// MatrixForm 相当于 MatrixForm[ f[ ] ]
>在输出上右键，复制为LaTex

生成一堆$ax^2+bx+c=0$里面的abc
```
arg[a_, b_, c_] := 
 Table[{x, y, z}, {x, Range[a]}, {y, Range[b]}, {z, Range[c]}]
out=arg[2, 2, 2] ;
```
应用到解方程的那个函数里
```
Apply[two, arg[2, 2, 2], {3}]
```

### 纯函数（匿名函数）

对于$f(x)=x^2$这个函数，可以这样定义
```
In[199]:= 
f1[x_] := x^2;
f2 = #^2 &;
f1[5] 
f2[5]
Out[201]= 25
Out[202]= 25
```
第二个就是纯函数了 

* \#代表第一个参数，`#1，#2，#3`就是其他的

* 用&结尾

有了这种写法，把上面的two和arg改造一下
结果
```
Apply[Solve[#1 x^2 + #2 x + #3 == 0, x ] &, 
    Table[{x, y, z}, 
        {x, Range[#1]},
        {y, Range[#2]}, 
        {z, Range[#3]}] &[2,2, 2], {3}]
```
再用Replace和Map映射所有结果输出到文件，就可以给其他程序处理了

```
Map[Print[N[Re[#]], ",", N[Im[#]]] &, 
  Replace[x, 
   Apply[Solve[#1 x^2 + #2 x + #3 == 0, x ] &, 
    Table[{x, y, z}, 
    {x, Range[#1]}, 
    {y, Range[#2]}, 
    {z, Range[#3]}] &[2, 2, 2], 
  {3}]], 
{4}];
```



## 命令行运行
把所有代码文本放到一个txt文件，改下后缀成`.m`,然后用命令 
```
math -script filename.m >out.csv
```
完事

































